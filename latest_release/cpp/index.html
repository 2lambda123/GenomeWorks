<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GenomeWorks: GenomeWorks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GenomeWorks
   &#160;<span id="projectnumber">0.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GenomeWorks </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>GenomeWorks is a GPU-accelerated library for biological sequence analysis. This section provides a brief overview of the different components of GenomeWorks. For more detailed API documentation please refer to the <a href="#enable-doc-generation">documentation</a>.</p>
<ul>
<li>Modules<ul>
<li><a href="#cudamapper">cudamapper</a> - CUDA-accelerated sequence to sequence mapping</li>
<li><a href="#cudapoa">cudapoa</a> - CUDA-accelerated partial order alignment</li>
<li><a href="#cudaaligner">cudaaligner</a> - CUDA-accelerated pairwise sequence alignment</li>
</ul>
</li>
<li>Setup GenomeWorks<ul>
<li><a href="#clone-genomeworks">Clone GenomeWorks</a></li>
<li><a href="#system-requirements">System Requirements</a></li>
<li><a href="#genomeworks-setup">GenomeWorks Installation</a></li>
</ul>
</li>
<li><a href="#genomeworks-python-api">Python API</a></li>
<li><a href="#development-support">Development Support</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
cudamapper</h2>
<p>The <code>cudamapper</code> package provides minimizer-based GPU-accelerated approximate mapping.</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Tool - &lt;em&gt;cudamapper&lt;/em&gt;</h3>
<p><code>cudamapper</code> is an end-to-end command line to for sequence to sequence mapping. <code>cudamapper</code> outputs mappings in the PAF format and is currently optimised for all-vs-all long read (ONT, Pacific Biosciences) sequences.</p>
<p>To run all-vs all overlaps use the following command:</p>
<p><code>cudamapper in.fasta in.fasta</code></p>
<p>A query fasta can be mapped to a reference as follows:</p>
<p><code>cudamapper query.fasta target.fasta</code></p>
<p>To access more information about running cudamapper, run <code>cudamapper --help</code>.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Library - &lt;em&gt;libcudamapper.so&lt;/em&gt;</h3>
<ul>
<li><code>Indexer</code> module to generate an index of minimizers from a list of sequences.</li>
<li><code>Matcher</code> module to find locations of matching pairs of minimizers between sequences using minimizer indices.</li>
<li><code>Overlapper</code> module to generate overlaps from sequence of minimizer matches generated by matcher.</li>
</ul>
<h3><a class="anchor" id="autotoc_md5"></a>
Sample - &lt;em&gt;sample_cudamapper&lt;/em&gt;</h3>
<p>A prototypical binary highlighting the usage of <code>libcudamapper.so</code> APIs (indexer, matcher and overlapper) and techniques to tie them into an application.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
cudapoa</h2>
<p>The <code>cudapoa</code> package provides a GPU-accelerated implementation of the <a href="https://simpsonlab.github.io/2015/05/01/understanding-poa/">Partial Order Alignment</a> algorithm. It is heavily influenced by <a href="https://github.com/rvaser/spoa">SPOA</a> and in many cases can be considered a GPU-accelerated replacement. Features include:</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Tool - &lt;em&gt;cudapoa&lt;/em&gt;</h3>
<p>A command line tool for generating consensus and MSA from a list of <code>fasta</code>/<code>fastq</code> files. The tool is built on top of <code>libcudapoa.so</code> and showcases optimization strategies for writing high performance applications with <code>libcudapoa.so</code>.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Library - &lt;em&gt;libcudapoa.so&lt;/em&gt;</h3>
<ul>
<li>Generation of consensus sequences</li>
<li>Generation of multi-sequence alignments (MSAs)</li>
<li>Custom adaptive band implementation of POA</li>
<li>Support for long and short read sequences</li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
Sample - &lt;em&gt;sample_cudapoa&lt;/em&gt;</h3>
<p>A prototypical binary to showcase the use of <code>libcudapoa.so</code> APIs.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
cudaaligner</h2>
<p>The <code>cudaaligner</code> package provides GPU-accelerated global alignment. Features include:</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Library - &lt;em&gt;libcudaaligner.so&lt;/em&gt;</h3>
<ul>
<li>Short and long read support</li>
<li>Banded implementation with configurable band width for flexible performance and accuracy trade-off</li>
</ul>
<h3><a class="anchor" id="autotoc_md12"></a>
Sample - &lt;em&gt;sample_cudaaligner&lt;/em&gt;</h3>
<p>A prototypical binary to showcase the use of <code>libcudaaligner.so</code> APIs.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Clone GenomeWorks</h1>
<h2><a class="anchor" id="autotoc_md14"></a>
Latest released version</h2>
<p>This will clone the repo to the <code>master</code> branch, which contains code for latest released version and hot-fixes.</p>
<div class="fragment"><div class="line">git clone --recursive -b master https://github.com/clara-parabricks/GenomeWorks.git</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Latest development version</h2>
<p>This will clone the repo to the default branch, which is set to be the latest development branch. This branch is subject to change frequently as features and bug fixes are pushed.</p>
<div class="fragment"><div class="line">git clone --recursive https://github.com/clara-parabricks/GenomeWorks.git</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
System Requirements</h1>
<p>Minimum requirements -</p>
<ol type="1">
<li>Ubuntu 16.04 or Ubuntu 18.04</li>
<li>CUDA 9.0+ (official instructions for installing CUDA are available <a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">here</a>)</li>
<li>gcc/g++ 5.4.0+</li>
<li>Python 3.6.7+</li>
<li>CMake (&gt;= 3.0)</li>
</ol>
<h1><a class="anchor" id="autotoc_md17"></a>
GenomeWorks Setup</h1>
<h2><a class="anchor" id="autotoc_md18"></a>
Build and Install</h2>
<p>To build and install GenomeWorks -</p>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=install -Dgw_cuda_gen_all_arch=OFF</div>
<div class="line">make -j install</div>
</div><!-- fragment --><p>NOTE : The <code>gw_cuda_gen_all_arch=OFF</code> option pre-generates optimized code only for the GPU(s) on your system. For building a binary that pre-generates opimized code for all common GPU architectures, please remove the option or set it to <code>ON</code>.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Package generation</h2>
<p>Package generation puts the libraries, headers and binaries built by the <code>make</code> command above into a <code>.deb</code>/<code>.rpm</code> for portability and easy installation. The package generation itself doesn't guarantee any cross-platform compatibility.</p>
<p>It is recommended that a separate build and packaging be performed for each distribution and CUDA version that needs to be supported.</p>
<p>The type of package (deb vs rpm) is determined automatically based on the platform the code is being run on. To generate a package for the SDK -</p>
<div class="fragment"><div class="line">make package</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
genomeworks Python API</h1>
<p>The python API for the GenomeWorks SDK is available through the <code>genomeworks</code> python package. More details on how to use and develop <code>genomeworks</code> can be found in the README under <code>pygenomeworks</code> folder.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Development Support</h1>
<h2><a class="anchor" id="autotoc_md22"></a>
Enable Unit Tests</h2>
<p>To enable unit tests, add <code>-Dgw_enable_tests=ON</code> to the <code>cmake</code> command in the build step.</p>
<p>This builds GTest based unit tests for all applicable modules, and installs them under <code>${CMAKE_INSTALL_PREFIX}/tests</code>. These tests are standalone binaries and can be executed directly. e.g.</p>
<div class="fragment"><div class="line">cd $INSTALL_DIR</div>
<div class="line">./tests/cudapoatests</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23"></a>
Enable Benchmarks</h2>
<p>To enable benchmarks, add <code>-Dgw_enable_benchmarks=ON</code> to the <code>cmake</code> command in the build step.</p>
<p>This builds Google Benchmark based microbenchmarks for applicable modules. The built benchmarks are installed under <code>${CMAKE_INSTALL_PREFIX}/benchmarks/&lt;module&gt;</code> and can be run directly.</p>
<p>e.g. </p><div class="fragment"><div class="line">#INSTALL_DIR/benchmarks/cudapoa/multibatch</div>
</div><!-- fragment --><p>A description of each of the benchmarks is present in a README under the module's benchmark folder.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
Enable Doc Generation</h2>
<p>To enable document generation for GenomeWorks, please install <code>Doxygen</code> on your system. Once<code>Doxygen</code> has been installed, run the following to build documents.</p>
<div class="fragment"><div class="line">make docs</div>
</div><!-- fragment --><p>Docs are also generated as part of the default <code>all</code> target when <code>Doxygen</code> is available on the system.</p>
<p>To disable documentation generation add <code>-Dgw_generate_docs=OFF</code> to the <code>cmake</code> command in the <a href="#build">build step</a>.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Code Formatting</h2>
<p>GenomeWorks makes use of <code>clang-format</code> to format it's source and header files. To make use of auto-formatting, <code>clang-format</code> would have to be installed from the LLVM package (for latest builds, best to refer to <a href="http://releases.llvm.org/download.html">http://releases.llvm.org/download.html</a>).</p>
<p>Once <code>clang-format</code> has been installed, make sure the binary is in your path.</p>
<p>To add a folder to the auto-formatting list, use the macro <code>gw_enable_auto_formatting(FOLDER)</code>. This will add all cpp source/header files to the formatting list.</p>
<p>To auto-format, run the following in your build directory.</p>
<div class="fragment"><div class="line">make format</div>
</div><!-- fragment --><p>To check if files are correct formatted, run the following in your build directory.</p>
<div class="fragment"><div class="line">make check-format</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md26"></a>
Running CI Tests Locally</h2>
<p>Please note, your git repository will be mounted to the container, any untracked files will be removed from it. Before executing the CI locally, stash or add them to the index.</p>
<p>Requirements:</p><ol type="1">
<li>docker (<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a>)</li>
<li>nvidia-docker (<a href="https://github.com/NVIDIA/nvidia-docker">https://github.com/NVIDIA/nvidia-docker</a>)</li>
<li>nvidia-container-runtime (<a href="https://github.com/NVIDIA/nvidia-container-runtime">https://github.com/NVIDIA/nvidia-container-runtime</a>)</li>
</ol>
<p>Run the following command to execute the CI build steps inside a container locally: </p><div class="fragment"><div class="line">bash ci/local/build.sh -r &lt;GenomeWorks repo path&gt;</div>
</div><!-- fragment --><p> ci/local/build.sh script was adapted from <a href="https://github.com/rapidsai/cudf/tree/branch-0.11/ci/local">rapidsai/cudf</a></p>
<p>The default docker image is <b>clara-genomics-base:cuda10.0-ubuntu16.04-gcc5-py3.7</b>. Other images from <a href="https://hub.docker.com/r/gpuci/clara-genomics-base/tags">gpuci/clara-genomics-base</a> repository can be used instead, by using -i argument </p><div class="fragment"><div class="line">bash ci/local/build.sh -r &lt;GenomeWorks repo path&gt; -i gpuci/clara-genomics-base:cuda10.0-ubuntu18.04-gcc7-py3.6</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
